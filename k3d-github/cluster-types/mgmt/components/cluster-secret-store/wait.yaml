# apiVersion: v1
# kind: ServiceAccount
# metadata:
#   name: kubernetes-toolkit
#   namespace: external-secrets-operator
# ---
# apiVersion: rbac.authorization.k8s.io/v1
# kind: Role
# metadata:
#   name: kubernetes-toolkit
#   namespace: external-secrets-operator
# rules:
# - apiGroups:
#   - apps
#   resources:
#   - deployments
#   - statefulsets
#   verbs:
#   - get
#   - watch
#   - list
# ---
# apiVersion: rbac.authorization.k8s.io/v1
# kind: RoleBinding
# metadata:
#   name: kubernetes-toolkit
#   namespace: external-secrets-operator
# roleRef:
#   apiGroup: rbac.authorization.k8s.io
#   kind: Role
#   name: kubernetes-toolkit
# subjects:
# - kind: ServiceAccount
#   name: kubernetes-toolkit
#   namespace: external-secrets-operator
# ---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "20"
  name: kubernetes-toolkit
  namespace: external-secrets-operator
spec:
  template:
    spec:
      containers:
      - args:
        - wait-for
        - cluster-secret-store
        - --name
        - vault-kv-secret
        - --timeout-seconds
        - "60"
        image: kubefirst/kubernetes-toolkit:0.0.5
        imagePullPolicy: Always
        name: kubernetes-toolkit
      restartPolicy: OnFailure
      # serviceAccountName: kubernetes-toolkit
