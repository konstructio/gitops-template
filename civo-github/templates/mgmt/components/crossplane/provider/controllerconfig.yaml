apiVersion: pkg.crossplane.io/v1alpha1
kind: ControllerConfig
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: '10'
  labels:
    app: crossplane-provider-terraform
  name: terraform-config
spec:
  metadata:
    annotations:
      argocd.argoproj.io/sync-wave: '10'
      vault.hashicorp.com/agent-inject: "true"
      vault.hashicorp.com/role: "sa-crossplane-provider-terraform" 
      vault.hashicorp.com/auth-path: auth/kubernetes/kubefirst
      vault.hashicorp.com/agent-inject-secret-jwt-token: "identity/oidc/token/federated"
      vault.hashicorp.com/agent-inject-template-jwt-token: |
        {{- with secret "identity/oidc/token/federated" -}}
        {{ .Data.token }}
        {{- end }}
  args:
  - -d
  - --poll=2m
  envFrom:
  - secretRef:
      name: crossplane-secrets
  volumeMounts:
  - mountPath: /.cache
    name: helmcache
  volumes:
    - name: helmcache
      emptyDir:
        sizeLimit: 500Mi
